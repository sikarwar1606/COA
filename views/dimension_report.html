<!DOCTYPE html>
<html>
<head>
  <title>Product Samples Entry</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    th { background: #f4f4f4; }
    input { width: 80px; padding: 4px; }
    .submit-btn { padding: 10px 15px; background: green; color: white; border: none; cursor: pointer; }
  </style>
</head>
<body>

  <h2>Enter Product Samples (48 Samples)</h2>

  <!-- Product Name -->
  <label>Batch Number: </label>
  <input type="text" name="batch_number" id="batch_number" placeholder="2501001" required>
  <br><br>
  <label>Production Date: </label>
  <input type="text" name="production_date" id="production_date" placeholder="16/06/2002" required>
  <br><br>

  <!-- Samples Table -->
  <form id="productForm" onsubmit="submitData(event)">
    <table>
      <thead>
        <tr>
          <th>Sample No.</th>
          <th>Height</th>
          <th>Weight</th>
          <th>Diameter</th>
          <th>Thickness</th>
        </tr>
      </thead>
      <tbody>
        <!-- Generate 48 rows -->
        <!-- Row 1 -->
        <tr>
          <td>1</td>
          <td><input type="number" name="height" ></td>
          <td><input type="number" name="weight" ></td>
          <td><input type="number" name="diameter" ></td>
          <td><input type="number" name="thickness" ></td>
        </tr>

        <!-- Repeat 47 more rows -->
        <!-- Iâ€™ll generate them in a loop below -->
        <script>
          for (let i = 2; i <= 48; i++) {
            document.write(`
              <tr>
                <td>${i}</td>
                <td><input type="number" name="height" required></td>
                <td><input type="number" name="weight" required></td>
                <td><input type="number" name="diameter" required></td>
                <td><input type="number" name="thickness" required></td>
              </tr>
            `);
          }
        </script>
      </tbody>
    </table>

    <button type="submit" class="submit-btn">Submit</button>
  </form>

  <script>
    async function submitData(event) {
      event.preventDefault();

      const productName = document.getElementById("productName").value;
      const rows = document.querySelectorAll("tbody tr");

      let samples = [];
      rows.forEach(row => {
        const inputs = row.querySelectorAll("input");
        samples.push({
          height: parseFloat(inputs[0].value),
          weight: parseFloat(inputs[1].value),
          diameter: parseFloat(inputs[2].value),
          thickness: parseFloat(inputs[3].value)
        });
      });

      const res = await fetch("/add-product", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ productName, samples })
      });

      const data = await res.text();
      alert(data);
    }
  </script>

</body>
</html>
